# Global options (DEBE ir primero)
{
    # Email for Let's Encrypt
    email admin@trendsunion.com

    # Deshabilitar HTTPS autom√°tico hasta configurar DNS
    auto_https off

    # Admin API
    admin :2019
}

# Usar puerto 80 hasta que DNS funcione
:80 {
    # API routes first (more specific)
    handle /api/* {
        reverse_proxy api:3001
    }

    # Frontend routes (catch all)
    handle {
        reverse_proxy frontend:3000
    }

    # Basic security headers
    header {
        X-Content-Type-Options nosniff
        X-Frame-Options DENY
    }

    # Gzip compression
    encode gzip
}

# Redirect www to non-www
www.trendsunion.com {
    redir https://trendsunion.com{uri} permanent
}
