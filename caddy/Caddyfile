# Global options (DEBE ir primero)
{
    # Email for Let's Encrypt
    email admin@trendsunion.com

    # Admin API
    admin :2019
}

# Dominio principal con HTTPS autom√°tico
trendsunion.com {
    # API routes first (more specific)
    handle /api/* {
        reverse_proxy api:3001
    }

    # Frontend routes (catch all)
    handle {
        reverse_proxy frontend:3000
    }

    # Security headers
    header {
        X-Content-Type-Options nosniff
        X-Frame-Options DENY
        X-XSS-Protection "1; mode=block"
        Referrer-Policy "strict-origin-when-cross-origin"
    }

    # Gzip compression
    encode gzip
}

# Redirect www to non-www
www.trendsunion.com {
    redir https://trendsunion.com{uri} permanent
}
